<div class="top-filter ic appear-delayed ng-hide filter-2" ng-show="filter.loaded" ng-class="{'active':available.selectedItem === null}" ng-click="available.selectedItem = null" ng-controller="AvailableFilterCtrl as filter">
    <i class="fa fa-bars" ng-click="available.toggleExpand('all')"></i>
    <div class="filters">
        <i class="fa fa-folder-open-o" ng-class="{'inactive':available.filter.set.key === null}" ng-click="filter.expand.set = !filter.expand.set"></i>
        <span translate="RUNNER.AVAILABLE.FILTER.BEFORE_SET" ng-hide="available.filter.set.key === null && !filter.expand.set"></span>
        <div class="select" filter-select="filter.sets" filter-id="available.filter.set.id" ng-hide="!filter.expand.set"></div>
        <i class="fa fa-tag" ng-class="{'inactive':available.filter.tag.key === null}" ng-click="filter.expand.tag = !filter.expand.tag"></i>
        <span translate="RUNNER.AVAILABLE.FILTER.BEFORE_TAG" ng-hide="available.filter.tag.key === null && !filter.expand.tag"></span>
        <div class="select" filter-select="filter.tags" filter-id="available.filter.tag.id" ng-hide="!filter.expand.tag"></div>
    </div>
    <div class="actions">
        <button>
            <i class="fa fa-play"></i>
            <span translate="RUNNER.AVAILABLE.FILTER.RUN_ALL"></span>
        </button>
        <span translate="RUNNER.AVAILABLE.FILTER.BEFORE_ENVIRONMENT"></span>
        <div class="select" filter-select="available.environments" filter-id="available.filter.env.id"></div>
    </div>
</div>
<span translate="RUNNER.SELECT_ENVIRONMENT" class="hero-notice appear-delayed ng-hide" ng-show="available.loaded && available.filter.env.key === null"></span>
<ul class="main-content-list ng-hide filter-2" ng-show="available.storiesLoaded">
    <li class="ic cl list-animate" ng-repeat="book in storybooks() | storybookSearchFilter:app.searchQuery | storybookSetFilter:available.filter.set.key | storybookTagFilter:available.filter.tag.key | storybookPaginationFilter: available.currentPage : available.maxScenarios">
        <div ng-class="{'active':available.selectedItem === 'book'+book.id}" ng-click="available.selectedItem = 'book'+book.id">
            <div class="title">
                <i class="fa fa-bars" ng-click="available.toggleExpand('book',book.id)"></i>
                <span>{{ book.title }}</span>
            </div>
            <div class="actions">
                <button>
                    <i class="fa fa-play"></i>
                    <span translate="RUNNER.AVAILABLE.FILTER.RUN"></span>
                </button>
                <span translate="RUNNER.AVAILABLE.FILTER.BEFORE_ENVIRONMENT"></span>
                <div class="select" filter-select="available.environments" filter-id="available.filter.env.id"></div>
            </div>
        </div>
        <ul>
            <li class="ic cl" ng-repeat="story in book.stories | storySearchFilter:app.searchQuery:book.id | storySetFilter:available.filter.set.key | storyTagFilter:available.filter.tag.key">
                <div ng-class="{'active':available.selectedItem === 'story'+story.id}" ng-click="available.expandStory(book.id,story.id)">
                    <div class="title">
                        <i class="fa fa-caret-right"></i>
                        <span>{{ story.title }}</span>
                    </div>
                    <div class="actions">
                        <button>
                            <i class="fa fa-play"></i>
                            <span translate="RUNNER.AVAILABLE.FILTER.RUN"></span>
                        </button>
                        <span translate="RUNNER.AVAILABLE.FILTER.BEFORE_ENVIRONMENT"></span>
                        <div class="select" filter-select="available.environments" filter-id="available.filter.env.id"></div>
                    </div>
                </div>
                <ul ng-class="{'expand':story.expand === true || expand() === 'book'+book.id || expand() === 'all'}">
                    <li class="ic cl" ng-repeat="scenario in story.scenarios">
                        <div ng-class="{'active':available.selectedItem === 'scenario'+scenario.id}" ng-click="available.selectedItem = 'scenario'+scenario.id">
                            <div class="title">
                                <span>{{ scenario.title }}</span>
                            </div>
                            <div class="actions">
                                <button>
                                    <i class="fa fa-play"></i>
                                    <span translate="RUNNER.AVAILABLE.FILTER.RUN"></span>
                                </button>
                                <span translate="RUNNER.AVAILABLE.FILTER.BEFORE_ENVIRONMENT"></span>
                                <div class="select" filter-select="available.environments" filter-id="available.filter.env.id"></div>
                            </div>
                        </div>
                    </li>
                </ul>
            </li>
        </ul>
    </li>
</ul>
<div pagination ng-show="available.storiesLoaded" class="pagination appear-delayed ng-hide" has-next="available.hasMorePages()" current-page="available.currentPage" list-ref="available.storyListRef" />
